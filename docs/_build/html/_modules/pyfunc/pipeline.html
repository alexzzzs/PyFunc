<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pyfunc.pipeline &#8212; PyFunc 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=27fed22d" />
    <script src="../../_static/documentation_options.js?v=01f34227"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for pyfunc.pipeline</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Generator</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">reduce</span><span class="p">,</span> <span class="n">partial</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">Generic</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">cast</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.errors</span><span class="w"> </span><span class="kn">import</span> <span class="n">PipelineError</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.placeholder</span><span class="w"> </span><span class="kn">import</span> <span class="n">Placeholder</span>

<span class="c1"># Define a TypeVar for the value in the Pipeline</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>

<span class="c1"># ======================================================================</span>
<span class="c1"># The Complete and Corrected Pipeline Class</span>
<span class="c1"># ======================================================================</span>

<div class="viewcode-block" id="Pipeline">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Pipeline</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A chainable functional pipeline for transforming values or iterables.</span>
<span class="sd">    Supports chaining, conditional application, operator overloading, and more.</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">_custom_type_handlers</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">type</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="Pipeline.register_custom_type">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.register_custom_type">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">register_custom_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">custom_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span> <span class="n">handlers</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register custom type handlers for specific operations.&quot;&quot;&quot;</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_custom_type_handlers</span><span class="p">[</span><span class="n">custom_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">handlers</span></div>


<div class="viewcode-block" id="Pipeline.extend">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.extend">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">extend</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extend the Pipeline class with a new method.&quot;&quot;&quot;</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.from_iterable">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.from_iterable">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_iterable</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">iterable</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[T, None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a Pipeline from any iterable (tuple, set, generator, etc).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;Pipeline[Generator[T, None, None]]&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">(</span><span class="n">initial_value</span><span class="o">=</span><span class="nb">iter</span><span class="p">(</span><span class="n">iterable</span><span class="p">)))</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">_pipeline_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="c1"># _initial_value is the starting value for the pipeline when .get() is called</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span> <span class="o">=</span> <span class="n">initial_value</span>
        <span class="c1"># _pipeline_func is the accumulated function representing all chained operations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">_pipeline_func</span> <span class="k">if</span> <span class="n">_pipeline_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Representation for easier debugging.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Pipeline(initial_value=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">)</span><span class="si">}</span><span class="s2">, func=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;__name__&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;lambda&#39;</span><span class="si">}</span><span class="s2">)&quot;</span>

<div class="viewcode-block" id="Pipeline.get">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.get">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current value from the pipeline by applying all accumulated functions.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.clone">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.clone">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[T]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new Pipeline with the same initial value and accumulated function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">)</span></div>


    <span class="c1"># --- Core Methods ---</span>

<div class="viewcode-block" id="Pipeline.apply">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.apply">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">U</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[U]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply func to the value (or map over iterable). Chainable.&quot;&quot;&quot;</span>
        <span class="n">executable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">executable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.then">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.then">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">then</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">U</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[U]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for apply method for chaining operations.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.map">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.map">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">U</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[U, None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for apply method to map a function over elements.&quot;&quot;&quot;</span>
        <span class="n">executable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_map_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">U</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">yield from</span> <span class="p">(</span><span class="n">executable</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">executable</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_map_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.pipe">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.pipe">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">pipe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">funcs</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Any]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Applies a sequence of functions to the current value in order.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">chained_func</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">x</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">:</span>
                <span class="n">executable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">executable</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">chained_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.compose">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.compose">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">compose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">funcs</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Any]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compose multiple functions and apply them as a single transformation.&quot;&quot;&quot;</span>
        <span class="n">composed</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">f</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">g</span><span class="p">)(</span><span class="n">x</span><span class="p">)),</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">funcs</span><span class="p">))</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">composed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.reduce">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.reduce">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">reduce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">U</span><span class="p">],</span> <span class="n">initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[U]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply a function of two arguments cumulatively to the items of an iterable, from left to right, to reduce the iterable to a single value.&quot;&quot;&quot;</span>
        <span class="n">executable</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">Placeholder</span><span class="p">):</span>
            <span class="n">executable</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">as_reducer</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">executable</span> <span class="o">=</span> <span class="n">func</span> <span class="c1"># If not a Placeholder, assume it&#39;s a regular 2-arg function</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_reduce_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">U</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">initializer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="n">executable</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="n">executable</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">initializer</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;reduce() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_reduce_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.reduce_right">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.reduce_right">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">reduce_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">U</span><span class="p">],</span> <span class="n">initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[U]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply a function of two arguments cumulatively to the items of an iterable, from right to left, to reduce the iterable to a single value.&quot;&quot;&quot;</span>
        <span class="n">executable</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">Placeholder</span><span class="p">):</span>
            <span class="n">executable</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">as_reducer</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">executable</span> <span class="o">=</span> <span class="n">func</span> <span class="c1"># If not a Placeholder, assume it&#39;s a regular 2-arg function</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_reduce_right_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">U</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="c1"># Convert to list to allow reverse iteration and indexing</span>
                <span class="n">val_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">initializer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># If no initializer, start with the last element</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">val_list</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;reduce_right() of empty sequence with no initial value&quot;</span><span class="p">)</span>
                    <span class="n">acc</span> <span class="o">=</span> <span class="n">val_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">items</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">val_list</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Iterate from second to last to first</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">acc</span> <span class="o">=</span> <span class="n">initializer</span>
                    <span class="n">items</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">val_list</span><span class="p">)</span> <span class="c1"># Iterate from last to first</span>

                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                    <span class="n">acc</span> <span class="o">=</span> <span class="n">executable</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">acc</span><span class="p">)</span> <span class="c1"># Note: item, acc for right-to-left</span>
                <span class="k">return</span> <span class="n">acc</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;reduce_right() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_reduce_right_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


    <span class="c1"># --- Conditional Application ---</span>

<div class="viewcode-block" id="Pipeline.apply_if">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.apply_if">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">apply_if</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">condition</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Any]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply func to the entire value if condition is True (or condition(self.value) is True if callable).&quot;&quot;&quot;</span>
        <span class="n">executable_condition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span>
        <span class="n">executable_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_apply_if_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
            <span class="n">processed_val</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))</span> <span class="k">else</span> <span class="n">val</span>
            <span class="k">if</span> <span class="n">executable_condition</span><span class="p">(</span><span class="n">processed_val</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">executable_func</span><span class="p">(</span><span class="n">processed_val</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">processed_val</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_apply_if_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.when">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.when">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">when</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pred</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Any]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply `func` only if `pred(value)` is True.&quot;&quot;&quot;</span>
        <span class="n">executable_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
        <span class="n">executable_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_when_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
            <span class="n">processed_val</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))</span> <span class="k">else</span> <span class="n">val</span>
            <span class="k">if</span> <span class="n">executable_pred</span><span class="p">(</span><span class="n">processed_val</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">executable_func</span><span class="p">(</span><span class="n">processed_val</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">processed_val</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_when_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.unless">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.unless">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">unless</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pred</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Any]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply `func` only if `pred(value)` is False.&quot;&quot;&quot;</span>
        <span class="n">executable_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
        <span class="n">executable_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_unless_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
            <span class="n">processed_val</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))</span> <span class="k">else</span> <span class="n">val</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">executable_pred</span><span class="p">(</span><span class="n">processed_val</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">executable_func</span><span class="p">(</span><span class="n">processed_val</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">processed_val</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_unless_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.if_else">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.if_else">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">if_else</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pred</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span> <span class="n">then_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">],</span> <span class="n">else_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Any]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply `then_fn` if `pred(value)` is True, otherwise apply `else_fn`.&quot;&quot;&quot;</span>
        <span class="n">executable_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
        <span class="n">executable_then_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">then_fn</span><span class="p">)</span>
        <span class="n">executable_else_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">else_fn</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_if_else_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
            <span class="n">processed_val</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))</span> <span class="k">else</span> <span class="n">val</span>
            <span class="k">if</span> <span class="n">executable_pred</span><span class="p">(</span><span class="n">processed_val</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">executable_then_fn</span><span class="p">(</span><span class="n">processed_val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">executable_else_fn</span><span class="p">(</span><span class="n">processed_val</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_if_else_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


    <span class="c1"># --- Operator Overloads ---</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">U</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[U]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Allow using | operator for chaining: Pipeline(42) | square | half&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__rshift__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">U</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[U]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Allow using &gt;&gt; operator for chaining: Pipeline(42) &gt;&gt; square &gt;&gt; half&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

    <span class="c1"># --- Iterable Manipulation ---</span>
    
<div class="viewcode-block" id="Pipeline.pairwise">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.pairwise">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">pairwise</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[tuple[Any, Any], None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Group elements of a list into pairs as tuples.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_pairwise_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="k">yield</span> <span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">val</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;pairwise() can only be used on lists.&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_pairwise_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="Pipeline.filter">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.filter">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[T, None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter elements of an iterable based on a predicate.&quot;&quot;&quot;</span>
        <span class="n">executable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_filter_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">executable</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
                        <span class="k">yield</span> <span class="n">v</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;filter() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_filter_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.flatten">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.flatten">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[Any, None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Flatten one level of nested iterables.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_flatten_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                        <span class="k">yield from</span> <span class="n">item</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">item</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;flatten() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_flatten_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.flatten_deep">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.flatten_deep">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">flatten_deep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[Any, None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recursively flatten nested iterables.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_flatten_deep_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">def</span><span class="w"> </span><span class="nf">_flatten</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                        <span class="k">yield from</span> <span class="n">_flatten</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">i</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">yield from</span> <span class="n">_flatten</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;flatten_deep() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_flatten_deep_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.chunk">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.chunk">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">chunk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[list[T], None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Break a sequence into chunks of the given size.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_chunk_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="n">val</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># Convert to list to allow slicing</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">size</span><span class="p">):</span>
                    <span class="k">yield</span> <span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">size</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;chunk() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_chunk_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.window">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.window">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">window</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[list[T], None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a sliding window view over a sequence.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_window_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="n">val</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># Convert to list to allow slicing</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">-</span> <span class="n">size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
                    <span class="k">yield</span> <span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">size</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;window() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_window_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.sliding_reduce">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.sliding_reduce">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">sliding_reduce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">U</span><span class="p">],</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[U, None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create sliding windows and apply a function to each.&quot;&quot;&quot;</span>
        <span class="n">executable_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_sliding_reduce_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">U</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="n">val</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># Convert to list to allow slicing</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">-</span> <span class="n">size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">yield</span> <span class="n">executable_func</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">size</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;sliding_reduce() can only be used on iterables.&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_sliding_reduce_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.sliding_pairs">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.sliding_pairs">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">sliding_pairs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[list[T], None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a sliding window of pairs over a sequence.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.sort">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.sort">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">reverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[list[T]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort the iterable.&quot;&quot;&quot;</span>
        <span class="n">executable_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">if</span> <span class="n">key</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_sort_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">executable_key</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;sort() can only be used on iterables.&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_sort_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.unique">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.unique">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">unique</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[T, None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove duplicates from the iterable while preserving order.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_unique_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
                        <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                        <span class="k">yield</span> <span class="n">x</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;unique() can only be used on iterables.&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_unique_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.starmap">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.starmap">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">starmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">U</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[U, None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply a function to each tuple in a list of tuples.&quot;&quot;&quot;</span>
        <span class="n">executable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_starmap_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">U</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                        <span class="k">yield</span> <span class="n">executable</span><span class="p">(</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;starmap() can only be used on iterables of tuples.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;starmap() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_starmap_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.first">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.first">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">first</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Optional[T]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the first element of an iterable.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_first_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;first() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_first_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.last">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.last">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">last</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Optional[T]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the last element of an iterable.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_last_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span> <span class="c1"># Optimize for lists</span>
                        <span class="k">return</span> <span class="n">val</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="c1"># For other iterables, consume to get the last element</span>
                    <span class="n">last_item</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                        <span class="n">last_item</span> <span class="o">=</span> <span class="n">item</span>
                    <span class="k">return</span> <span class="n">last_item</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;last() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_last_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.nth">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.nth">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">nth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Optional[T]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the nth element of an iterable (0-indexed).&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_nth_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">val</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
                    <span class="c1"># For other iterables, iterate to the nth element</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
                            <span class="k">return</span> <span class="n">item</span>
                    <span class="k">return</span> <span class="kc">None</span> <span class="c1"># n is out of bounds</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;nth() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_nth_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.is_empty">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.is_empty">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[bool]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the iterable is empty.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_is_empty_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">return</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">val</span><span class="p">))</span> <span class="c1"># Convert to list to check emptiness</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;is_empty() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_is_empty_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.count">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.count">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[int]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Count the number of elements in an iterable.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_count_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;count() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_count_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.sum">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.sum">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Union[int, float]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the sum of elements in an iterable.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_sum_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;sum() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_sum_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.min">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.min">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Optional[T]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the minimum element in an iterable.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_min_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span> <span class="c1"># Empty sequence</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;min() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_min_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.max">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.max">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Optional[T]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the maximum element in an iterable.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_max_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span> <span class="c1"># Empty sequence</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;max() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_max_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.reverse">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.reverse">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[list[T]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reverse the order of elements in an iterable.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_reverse_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;reverse() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_reverse_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.take">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.take">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">take</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[T, None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Take the first n elements from the iterable.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_take_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">item</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;take() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_take_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.take_while">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.take_while">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">take_while</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[T, None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Take elements from the iterable as long as the predicate is true.&quot;&quot;&quot;</span>
        <span class="n">executable_predicate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_take_while_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">executable_predicate</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                        <span class="k">yield</span> <span class="n">item</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;take_while() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_take_while_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.skip">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.skip">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">skip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[T, None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Skip the first n elements from the iterable.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_skip_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">item</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;skip() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_skip_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.skip_while">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.skip_while">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">skip_while</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[T, None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Skip elements from the iterable as long as the predicate is true.&quot;&quot;&quot;</span>
        <span class="n">executable_predicate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_skip_while_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="n">skipping</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">skipping</span> <span class="ow">and</span> <span class="n">executable_predicate</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">skipping</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">yield</span> <span class="n">item</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;skip_while() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_skip_while_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.chain">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.chain">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">others</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[Any, None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Concatenate multiple sequences.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_chain_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">yield from</span> <span class="n">val</span>
                <span class="k">for</span> <span class="n">other_val</span> <span class="ow">in</span> <span class="n">others</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other_val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other_val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                        <span class="k">yield from</span> <span class="n">other_val</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;chain() can only concatenate iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;chain() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_chain_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.zip_with">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.zip_with">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">zip_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[tuple[Any, Any], None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Zip the current iterable with another iterable.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_zip_with_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
                <span class="k">yield from</span> <span class="nb">zip</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;zip_with() requires two iterables.&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_zip_with_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.product">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.product">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">product</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">iterables</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[tuple[Any, ...], None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cartesian product of input iterables.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_product_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">yield from</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="o">*</span><span class="n">iterables</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;product() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_product_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.combinations">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.combinations">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">combinations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[tuple[Any, ...], None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return r-length subsequences of elements from the input iterable.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_combinations_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="k">yield from</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;combinations() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_combinations_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.group_by">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.group_by">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">group_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[dict[Any, list[T]]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Group elements of an iterable based on a key function.&quot;&quot;&quot;</span>
        <span class="n">executable_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_group_by_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">T</span><span class="p">]]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
                <span class="n">grouped</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                    <span class="n">k</span> <span class="o">=</span> <span class="n">executable_key</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
                        <span class="n">grouped</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">grouped</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">grouped</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;group_by() can only be used on iterables (excluding str/bytes).&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_group_by_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.to_list">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.to_list">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Force evaluation of the pipeline and return the result as a list.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="p">]</span></div>


    <span class="c1"># --- String Manipulation ---</span>

<div class="viewcode-block" id="Pipeline.explode">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.explode">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">explode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[list[str]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Split a string by the given delimiter.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_explode_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">delimiter</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;explode() can only be used on strings.&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_explode_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.implode">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.implode">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">implode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[str]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Join a list of strings with the given delimiter.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_implode_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">val</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;implode() can only be used on lists of strings.&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_implode_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.surround">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.surround">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">surround</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[str]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrap the string with a prefix and suffix.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_surround_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">val</span><span class="si">}{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;surround() can only be used on strings.&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_surround_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.template_fill">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.template_fill">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">template_fill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[str]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply string templating from a key-value map.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_template_fill_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;template_fill() can only be used on strings.&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_template_fill_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


    <span class="c1"># --- Other Methods ---</span>
<div class="viewcode-block" id="Pipeline.tap">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.tap">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">tap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[T]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run func(self.value) for side effects, do not change value.&quot;&quot;&quot;</span>
        <span class="n">executable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">executable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Execute for side effect, return original</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.do">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.do">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">do</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[T]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for tap method for explicit side effects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tap</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.debug">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.debug">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">debug</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[T]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prints the current value of the pipeline for debugging purposes.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_debug_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DEBUG: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">val</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_debug_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.trace">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.trace">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[T]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prints the current value of the pipeline with a custom label for tracing.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_trace_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TRACE [</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">]: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">val</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_trace_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.tee">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.tee">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">tee</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="s1">&#39;Pipeline[T]&#39;</span><span class="p">,</span> <span class="s1">&#39;Pipeline[T]&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Duplicate the current pipeline into two independent pipelines.&quot;&quot;&quot;</span>
        <span class="c1"># Tee returns two new pipelines, both with the same initial value and accumulated function</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span></div>


<div class="viewcode-block" id="Pipeline.with_items">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.with_items">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">with_items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Generator[tuple[Any, Any], None, None]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a dictionary into a list of key-value pairs.&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_with_items_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">yield from</span> <span class="n">val</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;with_items() can only be used on dictionaries.&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_with_items_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.map_values">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.map_values">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">map_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">U</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[dict[Any, U]]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply a function to the values of a dictionary.&quot;&quot;&quot;</span>
        <span class="n">executable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_map_values_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">U</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">executable</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;map_values() can only be used on dictionaries.&quot;</span><span class="p">)</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_map_values_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.assert_">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.assert_">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">assert_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Assertion failed&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[T]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Throw an error if the predicate fails.&quot;&quot;&quot;</span>
        <span class="n">executable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unwrap</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_assert_func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">executable</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">val</span> <span class="c1"># Return value unchanged if assertion passes</span>
        <span class="n">new_pipeline_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_assert_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_value</span><span class="p">,</span> <span class="n">new_pipeline_func</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_unwrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Unwraps a function or placeholder into an executable callable.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">Placeholder</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="n">_func</span>  <span class="c1"># Access the single-argument callable from the placeholder</span>
        <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">func</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PipelineError</span><span class="p">(</span><span class="s2">&quot;Provided object is not callable or a valid placeholder.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Make the pipeline callable with an input value.&quot;&quot;&quot;</span>
        <span class="c1"># When called, the pipeline applies its accumulated function to the provided value</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline_func</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="Pipeline.add">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.add">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Any]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a number to the current value.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">number</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pipeline.subtract">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.Pipeline.subtract">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">subtract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Any]&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Subtract a number from the current value.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">number</span><span class="p">)</span></div>
</div>


<span class="c1"># Decorator for creating a pipeline from a function</span>
<div class="viewcode-block" id="pipeline">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.pipeline">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pipeline</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="s1">&#39;Pipeline[Any]&#39;</span><span class="p">],</span> <span class="s1">&#39;Pipeline[Any]&#39;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="s1">&#39;Pipeline[Any]&#39;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator to create a pipeline from a function.&quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="n">initial_value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[Any]&#39;</span><span class="p">:</span>
        <span class="n">p</span><span class="p">:</span> <span class="n">Pipeline</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">initial_value</span><span class="o">=</span><span class="n">initial_value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span></div>


<div class="viewcode-block" id="pipe">
<a class="viewcode-back" href="../../pyfunc.pipeline.html#pyfunc.pipeline.pipe">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pipe</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline[T]&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a new Pipeline instance with the given initial value.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">initial_value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">PyFunc</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">pyfunc</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2023, Your Name.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>